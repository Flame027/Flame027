# $Header: /cvs/stx/stx/libdb/nosql/minneStore/Make.proto,v 1.4 2014-02-17 21:19:29 cg Exp $
#
# --- Make.proto created by stmkmp at Thu Aug 23 23:40:30 CEST 2001
#
# Warning: once you modify this file, do not rerun
# stmkmp again - otherwise, your changes are lost.
#
# The Makefile as generated by this Make.proto supports the following targets:
#    make         - compile all st-files to a classLib
#    make install - install the classLib in /opt/smalltalk/...
#    make clean   - clean all temp files
#    make clobber - clean all

#
# position (of this package) in directory hierarchy:
# (must point to ST/X top directory, for tools and includes)
TOP=../../..
INCLUDE_TOP=$(TOP)/..

# subdirectories where targets are to be made:
SUBDIRS=

# subdirectories where Makefiles are to be made:
# (only define if different from SUBDIRS)
# ALLSUBDIRS=

LIBNAME=libstx_libdb_nosql_minneStore

# Argument(s) to the stc compiler.
#  -H.         : create header files locally
#                (if removed, they will be created as common
#  -Pxxx       : defines the package
#  -Zxxx       : a prefix for variables within the classLib
#  -Dxxx       : defines passed to to CC for inline C-code
#  -Ixxx       : include path passed to CC for inline C-code
#  +optspace   : optimized for space
#  +optspace2  : optimized more for space
#  +optspace3  : optimized even more for space
#  +optinline  : generate inline code for some ST constructs
#  +inlineNew  : additionally inline new
#  +inlineMath : additionally inline some floatPnt math stuff
#
# ********** OPTIONAL: MODIFY the next line(s) ***
# STCLOCALOPTIMIZATIONS=+optinline +inlineNew
# STCLOCALOPTIMIZATIONS=+optspace3
STCLOCALOPTIMIZATIONS=+optspace3


# Argument(s) to the stc compiler.
#  -warn            : no warnings
#  -warnNonStandard : no warnings about ST/X extensions
#  -warnEOLComments : no warnings about EOL comment extension
#  -warnPrivacy     : no warnings about privateClass extension
#
# ********** OPTIONAL: MODIFY the next line(s) ***
# STCWARNINGS=-warn
STCWARNINGS=-warnNonStandard
# STCWARNINGS=-warnEOLComments
# STCWARNINGS=


# if your embedded C code requires any system includes, 
# add the path(es) here:, 
# ********** OPTIONAL: MODIFY the next lines ***
# LOCALINCLUDES=-Ifoo -Ibar
LOCALINCLUDES=-I$(INCLUDE_TOP)/stx/libbasic


# if you need any additional defines for embedded C code, 
# add them here:, 
# ********** OPTIONAL: MODIFY the next lines ***
# LOCALDEFINES=-Dfoo -Dbar -DDEBUG
LOCALDEFINES=


#
# The next 2 defines should be left as-is
#  for a class-library package, you can uncomment the following:
#  (it does not hurt much, if you leave it as is - but you may NOT
#   uncomment it if object files are to be loaded individually later).
# INITCODESEPFLAG=$(SEPINITCODE)
#
#  the following MAY ONLY be uncommented for classes/classLibs,
#  which are ALWAYS statically included in the executable.
#  (i.e. not for those which are subject to dynamic loading).
# COMMONSYMFLAG=$(COMMONSYMBOLS)
#
STCLOCALOPT=-I. $(STCLOCALOPTIMIZATIONS) $(STCWARNINGS) $(LOCALINCLUDES) $(LOCALDEFINES) -H. '-P$(PACKAGE)' '-Z$(LIBNAME)' $(COMMONSYMFLAG) $(INITCODESEPFLAG)


# ********** OPTIONAL: MODIFY the next line ***
# additional C-libraries that should be pre-linked with the class-objects
LD_OBJ_LIBS=

# ********** OPTIONAL: MODIFY the next line ***
# additional C targets or libraries should be added below
LOCAL_EXTRA_TARGETS=

# if you use RCS, there are rules in the Makefile for ci/co
RCSSOURCES=*.st Make.proto

all:: preMake classLibRule postMake

TESTCASES=\
    CompatibilityTesting.$(O) \
    DiskObjectServicesTestCase.$(O) \
    MinneStoreTestCase1.$(O) \
    MinneStoreTestCase2.$(O) \
    MinneStoreTestCase3.$(O) \
    MinneStoreTestCase4.$(O) \
    MultiObjectTestCase.$(O) \
    SingleObjectTestCase.$(O) \
    DOTestObject.$(O) \
    Employee.$(O) \


EXAMPLES=\
    Assembly.$(O) \
    Part.$(O) \
    MSExample.$(O) \
    IndirizzoPersona.$(O) \


OBJS= \
    MinneStore.$(O) \
    MSTestClasses.$(O) \
    DiskObjectServices.$(O) \
    DODeletedObject.$(O) \
    DOInvalidVersionError.$(O) \
    DOLockStuckError.$(O) \
    DOService.$(O) \
    DOMultiObjectService.$(O) \
    DOObjectsPerFilePolicy.$(O) \
    DOMultiObjectsPerFilePolicy.$(O) \
    DOUserPolicy.$(O) \
    DOMultiUserPolicy.$(O) \
    DOSingleObjectPerFilePolicy.$(O) \
    DOSingleObjectService.$(O) \
    DOSingleUserPolicy.$(O) \
    DOTestException.$(O) \
    DOWrapper.$(O) \
    ExceptionCompatibility.$(O) \
    File.$(O) \
    FlavorCompatibility.$(O) \
    MSAspect.$(O) \
    MSBranch.$(O) \
    MSBranchAboutToMorph.$(O) \
    MSDeletedLeafException.$(O) \
    MSHighValue.$(O) \
    MSLeaf.$(O) \
    MSMultiObjectAspect.$(O) \
    MSReadProxy.$(O) \
    MSMultiObjectReadProxy.$(O) \
    MSStorageProxy.$(O) \
    MSMultiObjectStorageProxy.$(O) \
    MSNilValue.$(O) \
    MSObjectSet.$(O) \
    MSSingleObjectAspect.$(O) \
    MSSingleObjectReadProxy.$(O) \
    MSSingleObjectStorageProxy.$(O) \
    MSText.$(O) \
    MSTreeHolder.$(O) \
    MSTrunk.$(O) \
    MinneStoreDB.$(O) \
    extensions.$(O)

# add more install actions here
install::

# add more install actions for aux-files (resources) here
installAux::

# add more preMake actions here
preMake::

# add more postMake actions here
postMake:: cleanjunk

cleanjunk::

clean::
	-rm -f *.o *.H

clobber::
	-rm -f *.so *.dll

$(INSTALLBASE)::
	@test -d $@ || mkdir $@

$(INSTALLBASE)/packages:: $(INSTALLBASE)
	@test -d $@ || mkdir $@

$(INSTALLBASE)/packages/$(MODULE):: $(INSTALLBASE)/packages
	@test -d $@ || mkdir $@

$(INSTALLBASE)/packages/$(MODULE)/goodies:: $(INSTALLBASE)/packages/$(MODULE)
	@test -d $@ || mkdir $@

$(INSTALLBASE)/packages/$(MODULE)/goodies/minneStore:: $(INSTALLBASE)/packages/$(MODULE)/goodies
	@test -d $@ || mkdir $@

$(INSTALLBASE)/packages/$(MODULE)/$(MODULE_DIR):: $(INSTALLBASE)/packages/$(MODULE)
	@test -d $@ || mkdir $@

# if other things are to be compiled,
# add target definitions here,
# and list them in LOCAL_EXTRA_TARGETS above.
# (care for make syntax - TABS are required in the actions)
# foo:  foo.o
#         $(CC) -o foo foo.o
# 'make depend' will add dependency info between
# BEGIN...END below
#
# BEGINMAKEDEPEND --- do not remove this line; make depend needs it
# ENDMAKEDEPEND --- do not remove this line
